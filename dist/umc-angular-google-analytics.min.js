/**
 * UMC Angular Google Analytics - Easy tracking for your AngularJS application
 * @version v0.2.4 - 2016-08-04
 * @link http://github.com/laffer1/angular-google-analytics
 * @author Julien Bouquillon <julien@revolunet.com>,Luke Palnau <lpalnau@umich.edu>,Lucas Holt <lholt@umich.edu>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("umc-angular-google-analytics",[]).provider("Analytics",function(){"use strict";var a,b=!1,c=!0,d="",e="analytics.js",f="$routeChangeSuccess";this.trackers=[],this._logs=[],this.setAccount=function(a){var b={code:a,name:"",trackEcommerce:!1,ecommerceLoaded:!1,trackDisplayfeatures:!1,displayfeaturesLoaded:!1,trackEnhancedEcommerce:!1,enhancedEcommerceLoaded:!1};return 0===this.trackers.length?this.trackers.push(b):this.trackers[0]=b,!0},this.trackPages=function(a){return c=a,!0},this.trackPrefix=function(a){return d=a,!0},this.setDomainName=function(b){return a=b,!0},this.setFilename=function(a){return e=a,!0},this.setPageEvent=function(a){return f=a,!0},this.trackEcommerce=function(a,b){if("undefined"==typeof b||null===b||""===b)return this.trackers[0].trackEcommerce=a,a;for(var c=1;c<this.trackers.length;c++)if(this.trackers[c].name===b)return this.trackers[c].trackEcommerce=a,a;return!1},this.trackEnhancedEcommerce=function(a,b){if("undefined"==typeof b||null===b||""===b)return this.trackers[0].trackEnhancedEcommerce=a,a;for(var c=1;c<this.trackers.length;c++)if(this.trackers[c].name===b)return this.trackers[c].trackEnhancedEcommerce=a,a;return!1},this.trackDisplayFeatures=function(a,b){if("undefined"==typeof b||null===b||""===b)return this.trackers[0].trackDisplayfeatures=a,a;for(var c=1;c<this.trackers.length;c++)if(this.trackers[c].name===b)return this.trackers[c].trackDisplayfeatures=a,a;return!1},this.addTracker=function(a,b){if("undefined"==typeof b||null===b||""===b)return void(this.trackers[0].code=a);for(var c=1;c<this.trackers.length;c++)if(this.trackers[c].name===b)return void(this.trackers[c].code=a);this.trackers.push({code:a,name:b,trackEcommerce:!1,ecommerceLoaded:!1,trackDisplayfeatures:!1,displayfeaturesLoaded:!1,trackEnhancedEcommerce:!1,enhancedEcommerceLoaded:!1})},this.getTrackers=function(){return this.trackers},this.$get=["$document","$rootScope","$location","$window",function(g,h,i,j){this._createScriptTag=function(){if(0!==this.trackers.length){j.GoogleAnalyticsObject="__gaTracker",angular.isUndefined(j.__gaTracker)&&(j.__gaTracker=function(){angular.isUndefined(j.__gaTracker.q)&&(j.__gaTracker.q=[]),j.__gaTracker.q.push(arguments)},j.__gaTracker.l=1*new Date);var d={};a&&(d.cookieDomain=a),j.__gaTracker("create",this.trackers[0].code);for(var f=1;f<this.trackers.length;f++)j.__gaTracker("create",this.trackers[f].code,{name:this.trackers[f].name});this._loadDisplayFeatures(),this._loadEcommerce(),this._loadEnhancedEcommerce(),c&&this._trackPage(i.path(),h.pageTitle),function(){if(!angular.isUndefined(g[0])){var a=g[0].createElement("script");a.type="text/javascript",a.async=!0,a.src="//www.google-analytics.com/"+e;var b=g[0].getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}}(),b=!0}},this._log=function(){this._logs.push(arguments)},this._loadDisplayFeatures=function(){this.trackers[0].trackDisplayfeatures&&!this.trackers[0].displayfeaturesLoaded&&(this.trackers[0].displayfeaturesLoaded=!0,j.__gaTracker("require","displayfeatures","displayfeatures.js"),this._log("loadGA","displayfeatures"));for(var a=1;a<this.trackers.length;a++)this.trackers[a].displayfeaturesLoaded||(this.trackers[a].displayfeaturesLoaded=!0,j.__gaTracker(this.trackers[a].name+".require","displayfeatures","displayfeatures.js"),this._log("loadGA","displayfeatures "+this.trackers[a].name))},this._loadEcommerce=function(){!this.trackers[0].trackEcommerce||this.trackers[0].ecommerceLoaded||this.trackers[0].trackEnhancedEcommerce||(this.trackers[0].ecommerceLoaded=!0,j.__gaTracker("require","ecommerce","ecommerce.js"),this._log("loadGA","ecommerce"));for(var a=1;a<this.trackers.length;a++)this.trackers[a].ecommerceLoaded||(this.trackers[a].ecommerceLoaded=!0,j.__gaTracker(this.trackers[a].name+".require","ecommerce","ecommerce.js"),this._log("loadGA","ecommerce "+this.trackers[a].name))},this._loadEnhancedEcommerce=function(){this.trackers[0].trackEnhancedEcommerce&&!this.trackers[0].enhancedEcommerceLoaded&&(this.trackers[0].enhancedEcommerceLoaded=!0,j.__gaTracker("require","ec","ec.js"),this._log("loadGA","ec"));for(var a=1;a<this.trackers.length;a++)this.trackers[a].enhancedEcommerceLoaded||(this.trackers[a].enhancedEcommerceLoaded=!0,j.__gaTracker(this.trackers[a].name+".require","ec","ec.js"),this._log("loadGA","ec "+this.trackers[a].name))},this._trackPage=function(a,b){if(!angular.isUndefined(j.__gaTracker)){this._loadDisplayFeatures(),angular.isUndefined(a)&&(a=i.path());var c=d+a;""!==c&&"/"!==c.charAt(0)&&(c="/"+c);var e={page:c};angular.isUndefined(b)&&angular.isDefined(h.pageTitle)&&(b=h.pageTitle),angular.isDefined(b)&&""!==b&&(e.title=b),j.__gaTracker("send","pageview",e);for(var f=1;f<this.trackers.length;f++)j.__gaTracker(this.trackers[f].name+".send","pageview",e);this._log("pageview",arguments)}},this._trackEvent=function(a,b,c,d){if(!angular.isUndefined(j.__gaTracker)){var e={eventCategory:a,eventAction:b};"undefined"!=typeof c&&(e.eventLabel=c),"undefined"!=typeof d&&(!isNaN(parseFloat(d))&&isFinite(d)&&(d=0),e.eventValue=d),j.__gaTracker("send","event",e);for(var f=1;f<this.trackers.length;f++)j.__gaTracker(this.trackers[f].name+".send","event",e);this._log("event",arguments)}},this._addImpression=function(a,b,c,d,e,f,g,h,i){if(!angular.isUndefined(j.__gaTracker)){this._loadEnhancedEcommerce();var k={id:a,name:b,category:c,brand:d,variant:e,list:f,position:g,dimension1:h,price:i};this.trackers[0].trackEnhancedEcommerce&&(j.__gaTracker("ec:addImpression",k),this._log("ec:addImpression",arguments));for(var l=1;l<this.trackers.length;l++)this.trackers[l].trackEnhancedEcommerce&&(j.__gaTracker(this.trackers[l].name+".ec:addImpression",k),this._log("ec:addImpression",arguments))}},this._addProduct=function(a,b,c,d,e,f,g,h,i,k){if(!angular.isUndefined(j.__gaTracker)){this._loadEnhancedEcommerce();var l={id:a,name:b,category:c,brand:d,variant:e,position:f,dimension1:g,price:h,quantity:i,coupon:k};this.trackers[0].trackEnhancedEcommerce&&(j.__gaTracker("ec:addProduct",l),this._log("ec:addProduct",arguments));for(var m=1;m<this.trackers.length;m++)this.trackers[m].trackEnhancedEcommerce&&(j.__gaTracker(this.trackers[m].name+".ec:addProduct",l),this._log("ec:addProduct",arguments))}},this._addPromo=function(a,b,c,d){if(!angular.isUndefined(j.__gaTracker)){this._loadEnhancedEcommerce();var e={id:a,name:b,creative:c,position:d};this.trackers[0].trackEnhancedEcommerce&&(j.__gaTracker("ec:addPromo",e),this._log("ec:addPromo",arguments));for(var f=1;f<this.trackers.length;f++)this.trackers[f].trackEnhancedEcommerce&&(j.__gaTracker(this.trackers[f].name+".ec:addPromo",e),this._log("ec:addPromo",arguments));this._setAction("promo_click"),this._trackEvent("Internal Promotions","click",b)}},this._setAction=function(a,b){if(!angular.isUndefined(j.__gaTracker)){this._loadEnhancedEcommerce(),this.trackers[0].trackEnhancedEcommerce&&(j.__gaTracker("ec:setAction",a,b),this._log("ec:setAction",arguments));for(var c=1;c<this.trackers.length;c++)this.trackers[c].trackEnhancedEcommerce&&(j.__gaTracker(this.trackers[c].name+".ec:setAction",a,b),this._log("ec:setAction",arguments))}},this._addTrans=function(a,b,c,d,e,f){if(!angular.isUndefined(j.__gaTracker)){this._loadEcommerce(),null==f&&(f="USD");var g={id:a,affiliation:b,revenue:c,shipping:e,tax:d,currency:f};this.trackers[0].trackEcommerce&&(j.__gaTracker("ecommerce:addTransaction",g),this._log("ecommerce:addTransaction",arguments));for(var h=1;h<this.trackers.length;h++)this.trackers[h].trackEcommerce&&(j.__gaTracker(this.trackers[h].name+".ecommerce:addTransaction",g),this._log("ecommerce:addTransaction",arguments))}},this._addItem=function(a,b,c,d,e,f,g){if(!angular.isUndefined(j.__gaTracker)){this._loadEcommerce(),null==g&&(g="USD");var h={id:a,name:b,sku:c,category:d,price:e,quantity:f,currency:g};this.trackers[0].trackEcommerce&&(j.__gaTracker("ecommerce:addItem",h),this._log("ecommerce:addItem",arguments));for(var i=1;i<this.trackers.length;i++)this.trackers[i].trackEcommerce&&(j.__gaTracker(this.trackers[i].name+".ecommerce:addItem",h),this._log("ecommerce:addItem",arguments))}},this._trackTrans=function(){if(!angular.isUndefined(j.__gaTracker)){this._loadEcommerce(),this.trackers[0].trackEcommerce&&(j.__gaTracker("ecommerce:send"),this._log("ecommerce:send",arguments));for(var a=1;a<this.trackers.length;a++)this.trackers[a].trackEcommerce&&(j.__gaTracker(this.trackers[a].name+".ecommerce:send"),this._log("ecommerce:send",arguments))}},this._clearTrans=function(){if(!angular.isUndefined(j.__gaTracker)){this._loadEcommerce(),this.trackers[0].trackEcommerce&&(j.__gaTracker("ecommerce:clear"),this._log("ecommerce:clear",arguments));for(var a=1;a<this.trackers.length;a++)this.trackers[a].trackEcommerce&&(j.__gaTracker(this.trackers[a].name+".ecommerce:clear"),this._log("ecommerce:clear",arguments))}},this._trackSocial=function(a,b,c){if(!angular.isUndefined(j.__gaTracker)){var d={socialNetwork:a,socialAction:b,socialTarget:c};j.__gaTracker("send","social",d);for(var e=1;e<this.trackers.length;e++)j.__gaTracker(this.trackers[e].name+".send","social",d);this._log("trackSocial",arguments)}},this._createScriptTag();var k=this;return c&&h.$on(f,function(){k._trackPage(i.path(),h.pageTitle)}),{_logs:k._logs,trackers:k.trackers,trackPage:function(a,b){k._trackPage(a,b)},trackEvent:function(a,b,c,d){k._trackEvent(a,b,c,d)},addImpression:function(a,b,c,d,e,f,g,h){k._addImpression(a,b,c,d,e,f,g,h)},addProduct:function(a,b,c,d,e,f,g){k._addProduct(a,b,c,d,e,f,g)},addPromo:function(a,b,c,d){k._addPromo(a,b,c,d)},setAction:function(a,b){k._setAction(a,b)},addTrans:function(a,b,c,d,e){k._addTrans(a,b,c,d,e)},addItem:function(a,b,c,d,e,f){k._addItem(a,c,b,d,e,f)},trackTrans:function(){k._trackTrans()},clearTrans:function(){k._clearTrans()},trackSocial:function(a,b,c){k._trackSocial(a,b,c)},ga:function(){angular.isDefined(j.__gaTracker)&&j.__gaTracker(arguments)}}}]});
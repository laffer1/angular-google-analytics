/**
 * UMC Angular Google Analytics - Easy tracking for your AngularJS application
 * @version v0.1.7 - 2015-04-14
 * @link http://github.com/laffer1/angular-google-analytics
 * @author Julien Bouquillon <julien@revolunet.com>,Luke Palnau <lpalnau@umich.edu>,Lucas Holt <lholt@umich.edu>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("umc-angular-google-analytics",[]).provider("Analytics",function(){"use strict";var a,b=!1,c=!0,d="",e="analytics.js",f="$routeChangeSuccess",g=!1,h=!1,i=!1,j=!1;this.trackers=[],this._logs=[],this.setAccount=function(a){return 0===this.trackers.length?this.trackers.push({code:a,name:""}):this.trackers[0]={code:a,name:""},!0},this.trackPages=function(a){return c=a,!0},this.trackPrefix=function(a){return d=a,!0},this.setDomainName=function(b){return a=b,!0},this.setFilename=function(a){return e=a,!0},this.setPageEvent=function(a){return f=a,!0},this.trackEcommerce=function(a){return g=a,!0},this.trackDisplayFeatures=function(a){return i=a,!0},this.addTracker=function(a,b){if(null===b||""===b)return void(this.trackers[0].code=a);for(var c=1;c<this.trackers.length;c++)if(this.trackers[c].name===b)return void(this.trackers[c].code=a);this.trackers.push({code:a,name:b})},this.getTrackers=function(){return this.trackers},this.$get=["$document","$rootScope","$location","$window",function(k,l,m,n){this._createScriptTag=function(){if(0!==this.trackers.length){n.GoogleAnalyticsObject="__gaTracker",angular.isUndefined(n.__gaTracker)&&(n.__gaTracker=function(){angular.isUndefined(n.__gaTracker.q)&&(n.__gaTracker.q=[]),n.__gaTracker.q.push(arguments)},n.__gaTracker.l=1*new Date);var d={};a&&(d.cookieDomain=a),n.__gaTracker("create",this.trackers[0].code);for(var f=1;f<this.trackers.length;f++)n.__gaTracker("create",this.trackers[f].code,{name:this.trackers[f].name});g&&!h&&(n.__gaTracker("require","ecommerce","ecommerce.js"),h=!0,this._log("loadGA","ecommerce")),i&&!j&&(n.__gaTracker("require","displayfeatures","displayfeatures.js"),j=!0,this._log("loadGA","displayfeatures")),c&&this._trackPage(m.path(),l.pageTitle),function(){var a=k[0].createElement("script");a.type="text/javascript",a.async=!0,a.src="//www.google-analytics.com/"+e;var b=k[0].getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}(),b=!0}},this._log=function(){this._logs.push(arguments)},this._trackPage=function(a,b){if(!angular.isUndefined(n.__gaTracker)){i&&!j&&(n.__gaTracker("require","displayfeatures","displayfeatures.js"),j=!0,this._log("loadGA","displayfeatures")),angular.isUndefined(a)&&(a=m.path());var c=d+a;""!==c&&"/"!==c.charAt(0)&&(c="/"+c);var e={page:c};angular.isUndefined(b)&&angular.isDefined(l.pageTitle)&&(b=l.pageTitle),angular.isDefined(b)&&""!==b&&(e.title=b),n.__gaTracker("send","pageview",e);for(var f=1;f<this.trackers.length;f++)n.__gaTracker(this.trackers[f].name+".send","pageview",e);this._log("pageview",arguments)}},this._trackEvent=function(a,b,c,d){angular.isUndefined(n.__gaTracker)||(n.__gaTracker("send","event",{eventCategory:a,eventAction:b,eventLabel:c,eventValue:d}),this._log("event",arguments))},this._addTrans=function(a,b,c,d,e){angular.isUndefined(n.__gaTracker)||(g&&!h&&(n.__gaTracker("require","ecommerce","ecommerce.js"),h=!0,this._log("loadGA","ecommerce")),n.__gaTracker("ecommerce:addTransaction",{id:a,affiliation:b,revenue:c,shipping:e,tax:d}),this._log("ecommerce:addTransaction",arguments))},this._addItem=function(a,b,c,d,e,f){angular.isUndefined(n.__gaTracker)||(n.__gaTracker("ecommerce:addItem",{id:a,name:b,sku:c,category:d,price:e,quantity:f}),this._log("ecommerce:addItem",arguments))},this._trackTrans=function(){angular.isUndefined(n.__gaTracker)||(n.__gaTracker("ecommerce:send"),this._log("ecommerce:send",arguments))},this._clearTrans=function(){angular.isUndefined(n.__gaTracker)||(n.__gaTracker("ecommerce:clear"),this._log("ecommerce:clear",arguments))},this._trackSocial=function(a,b,c){angular.isUndefined(n.__gaTracker)||(n.__gaTracker("send","social",{socialNetwork:a,socialAction:b,socialTarget:c}),this._log("trackSocial",arguments))},this._createScriptTag();var o=this;return c&&l.$on(f,function(){o._trackPage(m.path(),l.pageTitle)}),{_logs:o._logs,trackers:o.trackers,trackPage:function(a,b){o._trackPage(a,b)},trackEvent:function(a,b,c,d){o._trackEvent(a,b,c,d)},addTrans:function(a,b,c,d,e){o._addTrans(a,b,c,d,e)},addItem:function(a,b,c,d,e,f){o._addItem(a,c,b,d,e,f)},trackTrans:function(){o._trackTrans()},clearTrans:function(){o._clearTrans()},trackSocial:function(a,b,c){o._trackSocial(a,b,c)},ga:function(){angular.isDefined(n.__gaTracker)&&n.__gaTracker(arguments)}}}]});